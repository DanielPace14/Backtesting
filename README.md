# Backtesting

This is a Python program that backtests a financial strategy model using market information extracted from Yahoo Finance and an accompanying performance analysis program using a Combinatorically Symmetric Cross-Validation.
## Financial Strategies

### Simple Moving Average Crossover

A simple moving average crossover strategy where a buy signal is generated when the short-term SMA crosses above the long-term SMA, and a sell signal is generated when the short-term SMA crosses below the long-term SMA.

### Exponential Moving Average Crossover

An exponential moving average crossover strategy where a buy signal is generated when the short-term EMA crosses above the long-term EMA and the medium-term EMA also crosses above the long-term EMA. A sell signal is generated when the short-term EMA crosses below the long-term EMA.

### Relative Strength Index

The RSI is a momentum oscillator that measures the speed and change of price movements and helps identify overbought and oversold conditions in an asset. This is an RSI-based strategy where a buy signal is generated when the RSI value is below 30 and the short-term EMA crosses above the long-term EMA. A sell signal is generated when the RSI value is above 70 and the short-term EMA crosses below the long-term EMA.

## Combinatorically Symmetric Cross-Validation

The combinatorically symmetric cross-validation (CSCV) was first proposed by Bailey et al. (2014, 2016) as a way of estimating the probability of backtest overfitting (PBO). To implement this method, we begin by collecting performance information on the multiple strategies as a function of time. A matrix M is formed with this information, where every column represents the performance of individual strategies, given as N, over the observations (time) T. The matrix created will then have dimensions T x N. Next, the matrix must be subdivided through the rows into an even number, 𝑆, of submatrices 𝑀𝑠, where the dimension of each submatrix will be 𝑇𝑆⁄×𝑁. As such, a matrix that contained 64 rows, if subdivided into S = 16 submatrices, will have N columns, each one for a strategy, and will have 64⁄16=4 rows. Next, the submatrices will be reconstituted in every possible combination of size 𝑆⁄2. Using the previous example, this means that 8 out of the 16 submatrices will be recombined to form another matrix, which is a training set 𝐽 of order (𝑇⁄2×𝑁). This is done for every combination <sub>S</sub>C<sub>S/2</sub>, therefore if S = 16, the number of possible combinations will be 12,780. For each combination, 𝐽, the testing set 𝐽' is formed from its complement. The testing set is formed by the submatrices that are not found in the training set. These two sets can be seen as the in-sample and out-of-sample data from traditional cross-validation techniques. For every possible combination of the submatrices, half of them will be found in the training set (𝐽) and the other half will be in the testing set (𝐽'). A performance vector 𝑅 is created from the training set, by taking the mean performance and dividing it by the standard deviation. Another performance vector is created for 𝐽', named 𝑅'. The best-performing strategy in R is found and compared to the other strategies in 𝐽'. Its percentile rank in 𝐽' is determined as 𝜔̅<sub>𝑐</sub>∈(0,1). A logit value is defined as 𝜆𝑐= log[𝜔̅𝑐/1−𝜔̅𝑐]. A high logit value is indicative of consistency between the training set and the testing set, meaning it is not very much overfit. All the logit values for every combination are collected in a histogram, where a probability density function (𝑓(𝜆)) can be fit, where ∫∞,−∞𝑓(𝜆)𝑑𝜆=1. Finally, the probability that the backtest is overfit can be estimated as ∅=∫0,−∞𝑓(𝜆)𝑑𝜆. This will give the probability of in-sample optimal strategies that underperformed out of the sample. If ∅≈0, then a low proportion of the in-sample optimal strategies outperformed out of sample which indicates no overfitting. If ∅≈1, then there is significant overfitting. The general value ∅ provides a quantitative measure of overfitting, and so any value deemed too high, such as larger than 5%, can be rejected. The estimates for the probability of overfitting can also be used to compute a weighted portfolio given by a certain scheme such as 1⁄𝑃𝐵𝑂.
